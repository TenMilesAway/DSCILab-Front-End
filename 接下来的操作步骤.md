# æ¥ä¸‹æ¥çš„æ“ä½œæ­¥éª¤æŒ‡å—

## ğŸ‰ å½“å‰çŠ¶æ€

âœ… **æ•°æ®åº“è¡¨**: å·²åˆ›å»º `lab_user` è¡¨å¹¶æ’å…¥æµ‹è¯•æ•°æ®  
âœ… **ä»£ç ç¼–è¯‘**: æ‰€æœ‰ä»£ç ç¼–è¯‘æˆåŠŸ  
âœ… **åº”ç”¨å¯åŠ¨**: åç«¯æœåŠ¡è¿è¡Œåœ¨ http://localhost:8080  
âœ… **æ¥å£åˆ›å»º**: å®éªŒå®¤ç”¨æˆ·ç®¡ç†æ¥å£å·²å®Œæˆ  

## ğŸ”§ ç¬¬å››æ­¥ï¼šè§£å†³ç™»å½•é—®é¢˜å¹¶æµ‹è¯•æ¥å£

### 4.1 ä¸´æ—¶è§£å†³æ–¹æ¡ˆ - åˆ›å»ºæµ‹è¯•æ¥å£

ç”±äºç³»ç»Ÿä½¿ç”¨RSAåŠ å¯†ç™»å½•ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªä¸éœ€è¦ç™»å½•çš„æµ‹è¯•æ¥å£ï¼š

```bash
# 1. åœæ­¢å½“å‰åº”ç”¨
# æŒ‰ Ctrl+C åœæ­¢åº”ç”¨

# 2. æ·»åŠ æµ‹è¯•æ¥å£ï¼ˆæ— éœ€è®¤è¯ï¼‰
# åœ¨ LabUserController ä¸­æ·»åŠ ä¸€ä¸ªå…¬å¼€æ¥å£
```

### 4.2 ä¿®æ”¹å®‰å…¨é…ç½®

éœ€è¦åœ¨ `SecurityConfig` ä¸­æ·»åŠ æˆ‘ä»¬çš„æ¥å£åˆ°ç™½åå•ï¼š

```java
// åœ¨ SecurityConfig.java ä¸­æ·»åŠ 
.antMatchers("/lab/users/*/exists").permitAll()
.antMatchers("/lab/users/test/**").permitAll()
```

### 4.3 è·å–æ­£ç¡®çš„ç™»å½•Token

æœ‰å‡ ç§æ–¹å¼è§£å†³ç™»å½•é—®é¢˜ï¼š

#### æ–¹å¼1: ä½¿ç”¨ç°æœ‰ç³»ç»Ÿç”¨æˆ·
```bash
# æŸ¥çœ‹ç³»ç»Ÿä¸­çš„ç”¨æˆ·
docker exec mysql8 mysql -uroot -p12345 -e "USE web; SELECT username FROM sys_user WHERE status = 1;"

# ä½¿ç”¨æ­£ç¡®çš„å¯†ç ï¼ˆå¯èƒ½æ˜¯ 123456 æˆ–å…¶ä»–ï¼‰
```

#### æ–¹å¼2: åˆ›å»ºæ–°çš„æµ‹è¯•ç”¨æˆ·
```sql
-- åœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªç®€å•çš„æµ‹è¯•ç”¨æˆ·
INSERT INTO sys_user (username, nickname, password, status, is_admin) 
VALUES ('testuser', 'æµ‹è¯•ç”¨æˆ·', '$2a$10$7JB720yubVSOfvVWdBYoOe.PuiKloYAjYcGpVFurpKhS6gqpHxYw6', 1, false);
```

#### æ–¹å¼3: ç¦ç”¨å¯†ç åŠ å¯†ï¼ˆä»…ç”¨äºæµ‹è¯•ï¼‰
ä¸´æ—¶ä¿®æ”¹ `LoginService.java` ä¸­çš„å¯†ç è§£å¯†é€»è¾‘ã€‚

## ğŸ§ª ç¬¬äº”æ­¥ï¼šæµ‹è¯•æ¥å£åŠŸèƒ½

### 5.1 è·å–Tokenåæµ‹è¯•

ä¸€æ—¦è·å¾—æœ‰æ•ˆTokenï¼Œæµ‹è¯•ä»¥ä¸‹æ¥å£ï¼š

```bash
# è®¾ç½®Tokenå˜é‡
TOKEN="your-jwt-token-here"

# 1. æµ‹è¯•è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
curl -X GET "http://localhost:8080/lab/users/profile" \
  -H "Authorization: Bearer $TOKEN"

# 2. æµ‹è¯•æ ¹æ®IDè·å–ç”¨æˆ·ä¿¡æ¯
curl -X GET "http://localhost:8080/lab/users/1" \
  -H "Authorization: Bearer $TOKEN"

# 3. æµ‹è¯•æ ¹æ®ç”¨æˆ·åè·å–ä¿¡æ¯
curl -X GET "http://localhost:8080/lab/users/username/admin" \
  -H "Authorization: Bearer $TOKEN"

# 4. æµ‹è¯•æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨
curl -X GET "http://localhost:8080/lab/users/1/exists" \
  -H "Authorization: Bearer $TOKEN"

# 5. æµ‹è¯•æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å­˜åœ¨
curl -X GET "http://localhost:8080/lab/users/username/admin/exists" \
  -H "Authorization: Bearer $TOKEN"
```

### 5.2 éªŒè¯æƒé™æ§åˆ¶

æµ‹è¯•ä¸åŒè§’è‰²çš„æƒé™ï¼š

```bash
# ç®¡ç†å‘˜åº”è¯¥èƒ½è®¿é—®æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯
# æ™®é€šç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„ä¿¡æ¯
```

## ğŸš€ ç¬¬å…­æ­¥ï¼šæ‰©å±•åŠŸèƒ½å¼€å‘

### 6.1 æˆæœç®¡ç†æ¥å£

åŸºäºç°æœ‰æ¶æ„ï¼Œç»§ç»­å¼€å‘ï¼š

#### 6.1.1 åˆ›å»ºæˆæœç›¸å…³è¡¨
```sql
-- åˆ›å»ºæˆæœè¡¨
CREATE TABLE lab_achievement (...);

-- åˆ›å»ºæˆæœç”¨æˆ·å…³è”è¡¨  
CREATE TABLE lab_achievement_user (...);
```

#### 6.1.2 åˆ›å»ºæˆæœç®¡ç†æ¥å£
```java
// 1. åˆ›å»ºå®ä½“ç±»
LabAchievementEntity.java

// 2. åˆ›å»ºDTOç±»
LabAchievementDTO.java

// 3. åˆ›å»ºæœåŠ¡ç±»
LabAchievementService.java

// 4. åˆ›å»ºæ§åˆ¶å™¨
LabAchievementController.java
```

#### 6.1.3 æˆæœç®¡ç†åŠŸèƒ½
- è®ºæ–‡ç®¡ç† (CRUD)
- ä¸“åˆ©ç®¡ç† (CRUD)  
- é¡¹ç›®ç®¡ç† (CRUD)
- åŸºé‡‘ç®¡ç† (CRUD)
- æˆæœç»Ÿè®¡å’ŒæŸ¥è¯¢

### 6.2 ç”¨æˆ·ä¿¡æ¯ä¿®æ”¹æ¥å£

```java
// æ·»åŠ ç”¨æˆ·ä¿¡æ¯ä¿®æ”¹æ¥å£
@PutMapping("/profile")
public ResponseDTO<Void> updateProfile(@RequestBody UpdateProfileCommand command);

// æ·»åŠ å¯†ç ä¿®æ”¹æ¥å£
@PutMapping("/password")  
public ResponseDTO<Void> changePassword(@RequestBody ChangePasswordCommand command);

// æ·»åŠ å¤´åƒä¸Šä¼ æ¥å£
@PostMapping("/avatar")
public ResponseDTO<String> uploadAvatar(@RequestParam("file") MultipartFile file);
```

### 6.3 ç”¨æˆ·åˆ—è¡¨å’Œæœç´¢

```java
// ç”¨æˆ·åˆ—è¡¨æŸ¥è¯¢ï¼ˆåˆ†é¡µï¼‰
@GetMapping
public ResponseDTO<PageDTO<LabUserProfileDTO>> getUserList(LabUserQuery query);

// ç”¨æˆ·æœç´¢
@GetMapping("/search")
public ResponseDTO<List<LabUserProfileDTO>> searchUsers(@RequestParam String keyword);
```

## ğŸ“‹ ç¬¬ä¸ƒæ­¥ï¼šå‰ç«¯å¯¹æ¥

### 7.1 æä¾›ç»™å‰ç«¯çš„ä¿¡æ¯

1. **APIæ–‡æ¡£**: `å®éªŒå®¤ç”¨æˆ·APIæ¥å£æ–‡æ¡£.md`
2. **æ¥å£åœ°å€**: `http://localhost:8080`
3. **è®¤è¯æ–¹å¼**: JWT Token
4. **æµ‹è¯•è´¦å·**: æä¾›æµ‹è¯•ç”¨æˆ·åå’Œå¯†ç 

### 7.2 å‰ç«¯éœ€è¦å®ç°çš„åŠŸèƒ½

1. **ç™»å½•é¡µé¢**: è·å–Token
2. **ä¸ªäººä¿¡æ¯é¡µé¢**: æ˜¾ç¤ºå’Œç¼–è¾‘ä¸ªäººä¿¡æ¯
3. **ç”¨æˆ·ç®¡ç†é¡µé¢**: ç®¡ç†å‘˜æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·
4. **æˆæœç®¡ç†é¡µé¢**: ç®¡ç†è®ºæ–‡ã€ä¸“åˆ©ã€é¡¹ç›®ç­‰

## ğŸ” ç¬¬å…«æ­¥ï¼šæµ‹è¯•å’Œè°ƒè¯•

### 8.1 å•å…ƒæµ‹è¯•

```java
// ä¸ºå…³é”®ä¸šåŠ¡é€»è¾‘ç¼–å†™å•å…ƒæµ‹è¯•
@Test
public void testGetCurrentUserProfile() {
    // æµ‹è¯•è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
}

@Test  
public void testUserPermission() {
    // æµ‹è¯•æƒé™æ§åˆ¶
}
```

### 8.2 é›†æˆæµ‹è¯•

```bash
# ä½¿ç”¨Postmanæˆ–å…¶ä»–å·¥å…·è¿›è¡Œå®Œæ•´çš„APIæµ‹è¯•
# æµ‹è¯•å„ç§è¾¹ç•Œæƒ…å†µå’Œé”™è¯¯å¤„ç†
```

### 8.3 æ€§èƒ½æµ‹è¯•

```bash
# ä½¿ç”¨JMeteræˆ–å…¶ä»–å·¥å…·è¿›è¡Œå‹åŠ›æµ‹è¯•
# æµ‹è¯•æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
# æµ‹è¯•å¹¶å‘è®¿é—®
```

## ğŸ“ ç¬¬ä¹æ­¥ï¼šéƒ¨ç½²å‡†å¤‡

### 9.1 ç”Ÿäº§ç¯å¢ƒé…ç½®

```yaml
# application-prod.yml
spring:
  datasource:
    dynamic:
      datasource:
        master:
          url: jdbc:mysql://prod-db:3306/web
          username: ${DB_USERNAME}
          password: ${DB_PASSWORD}
  redis:
    host: ${REDIS_HOST}
    port: ${REDIS_PORT}
    password: ${REDIS_PASSWORD}
```

### 9.2 Dockeréƒ¨ç½²

```dockerfile
# Dockerfile
FROM openjdk:8-jre-alpine
COPY target/agileboot-admin-1.0.0.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "/app.jar", "--spring.profiles.active=prod"]
```

### 9.3 æ•°æ®åº“è¿ç§»

```sql
-- ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
-- åŒ…å«è¡¨ç»“æ„å’ŒåŸºç¡€æ•°æ®
```

## ğŸ¯ ä¼˜å…ˆçº§å»ºè®®

### é«˜ä¼˜å…ˆçº§ (ç«‹å³æ‰§è¡Œ)
1. âœ… è§£å†³ç™»å½•é—®é¢˜ï¼Œè·å–æœ‰æ•ˆToken
2. âœ… æµ‹è¯•ç°æœ‰çš„5ä¸ªç”¨æˆ·ç®¡ç†æ¥å£
3. âœ… éªŒè¯æƒé™æ§åˆ¶æ˜¯å¦æ­£å¸¸å·¥ä½œ

### ä¸­ä¼˜å…ˆçº§ (æœ¬å‘¨å®Œæˆ)
1. ğŸ”„ å¼€å‘ç”¨æˆ·ä¿¡æ¯ä¿®æ”¹æ¥å£
2. ğŸ”„ å¼€å‘æˆæœç®¡ç†åŸºç¡€æ¥å£
3. ğŸ”„ ç¼–å†™åŸºç¡€çš„å•å…ƒæµ‹è¯•

### ä½ä¼˜å…ˆçº§ (åç»­è¿­ä»£)
1. â³ å®Œå–„æˆæœç®¡ç†çš„é«˜çº§åŠŸèƒ½
2. â³ å¼€å‘ç»Ÿè®¡å’ŒæŠ¥è¡¨åŠŸèƒ½
3. â³ æ€§èƒ½ä¼˜åŒ–å’Œéƒ¨ç½²å‡†å¤‡

---

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**: é¦–å…ˆè§£å†³ç™»å½•é—®é¢˜ï¼Œç„¶åç«‹å³æµ‹è¯•æˆ‘ä»¬åˆ›å»ºçš„æ¥å£åŠŸèƒ½ï¼
